library(nycflights13)
view(flights)
View(flights)
View(flights)
View(airports)
View(planes)
View(airlines)
View(weather)
library(tidyverse)
library(nycflights13)
View(flights)
View(airports)
View(planes)
View(airlines)
View(weather)
View(flights)
View(airports)
View(planes)
View(airlines)
View(weather)
flights_planes <- flights %>% inner_join(planes,by="tailnum")
print(flights_planes)
flights_planes <- flights %>% inner_join(planes,by=c("tailnum","tailnum"))
flights_planes <- flights %>% inner_join(planes,by=c("tailnum"="tailnum"))
print(flights_planes)
flights_airlines <- flights %>% inner_join(airlines,by=c("carrier"="carrier"))
print(flights_airlines)
View(flights)
flights_airports <- flights %>% inner_join(airports,by=c("origin"="faa","dest"="faa"))
flights_airports <- flights %>% inner_join(airports,by=c("origin"="faa")) %>% inner_join(airports,by=c("dest"="faa"))
print(flights_airports)
print(flights_planes)
flights_planes <- flights %>% inner_join(planes,by="tailnum")
print(flights_planes)
flights_airlines <- flights %>% inner_join(airlines,by=c("carrier"))
print(flights_airlines)
flights_planes <- flights %>% inner_join(planes,by="tailnum")
flights_airlines <- flights %>% inner_join(airlines,by="carrier")
flights_airports <- flights %>% inner_join(airports,by=c("origin"="faa")) %>% inner_join(airports,by=c("dest"="faa"))
flights_weather <- flights %>% inner_join(weather,by=c("year"="year")) %>% inner_join(airports,by=c("dest"="faa"))
flights_planes <- flights %>% inner_join(planes,by="tailnum")
library(tidyverse)
library(nycflights13)
flights_planes <- flights %>% inner_join(planes,by="tailnum")
print(flights_planes)
flights_airlines <- flights %>% inner_join(airlines,by="carrier")
print(flights_airlines)
flights_airports <- flights %>% inner_join(airports,by=c("origin"="faa")) %>% inner_join(airports,by=c("dest"="faa"))
print(flights_airports)
flights_weather <- flights %>% inner_join(weather,by="year") %>% inner_join(airports,by="month") %>% inner_join(weather,by="day") %>% inner_join(weather,by="hour") %>% inner_join(weather,by="origin")
i2_1 <- flights %>% count(c("year","month","day"), sort = TRUE)
i2_1 <- count(flights,c("year","month","day"))
i2_1 <- flights %>% count(c("year","month","day"), sort = TRUE)
library(plyr)
install.packages("plyr")
i2_1 <- count(flights,count=c("year","month","day"))
i2_1 <- flights %>% count(c("year","month","day"), sort = TRUE)
i2_1 <- flights %>% count("year", sort = TRUE)
print(i2_1)
library(tidyr)
i2_1 <- flights %>% count("year", "month", sort = TRUE)
print(i2_1)
i2_1 <- flights %>% count("year", "month", "day," sort = TRUE)
i2_1 <- flights %>% count("year", "month", "day", sort = TRUE)
print(i2_1)
i2_1 <- flights %>% count(year, month, day, sort = TRUE)
print(i2_1)
i2_1 <- flights %>% count(year, month, day, sort = TRUE) %>% filter(n > 1000)
print(i2_1)
i2_1 <- flights %>% count(year, month, day, sort = TRUE)
print(i2_1)
i2_1 <- flights %>% count(year, month, day, sort = TRUE) %>% filter(n > 1000)
print(i2_1)
i2_1 <- flights %>% count(year, month, day, sort = TRUE) %>% filter(n > 1000) %>% arrange(n)
print(i2_1)
flights_count <- flights %>% count(year, month, day, sort = TRUE) %>% filter(n > 1000) %>% arrange(n)
print(flights_count)
flights_count <- flights %>% count(year, month, day, sort = TRUE) %>% filter(n > 1000) %>% arrange(n)
flights_selected <- flights["year":"day"]
flights_count <- flights %>% count(year, month, day, sort = TRUE) %>% filter(n > 1000) %>% arrange(n)
flights_selected <- flights["year","day"]
print(flights_count)
print(flights_selected)
flights_weather <- flights %>% inner_join(weather,by=c("year","month","day","hour","origin"))
print(flights_weather)
flights_planes <- flights %>% inner_join(planes,by="tailnum")
flights_airlines <- flights %>% inner_join(airlines,by="carrier")
flights_airports <- flights %>% inner_join(airports,by=c("origin"="faa")) %>% inner_join(airports,by=c("dest"="faa"))
flights_weather <- flights %>% inner_join(weather,by=c("year","month","day","hour","origin"))
print(flights_planes)
print(flights_airlines)
print(flights_airports)
print(flights_weather)
flights_count <- flights %>% count(year, month, day, sort = TRUE) %>% filter(n > 1000) %>% arrange(n)
flights_selected <- flights %>% select(year:day)
print(flights_count)
print(flights_selected)
flights_count <- flights %>% count(year, month, day, sort = TRUE) %>% filter(n > 1000) %>% arrange(n)
flights_selected <- flights %>% select(year:day, hour)
print(flights_count)
print(flights_selected)
flights_count <- flights %>% count(year, month, day, sort = TRUE) %>% filter(n > 1000) %>% arrange(n)
flights_selected <- flights %>% select(year:day, hour, origin, dest, tailnum, carrier, arr_delay, dep_delay)
print(flights_count)
print(flights_selected)
flights_count <- flights %>% count(year, month, day, sort = TRUE) %>% filter(n > 1000) %>% arrange(n)
flights_selected <- flights %>% select(year:day, hour, origin, dest, tailnum, carrier, arr_delay, dep_delay)
airlines_flights_selected <- airlines %>% left_join(flights_selected, by="carrier")
print(flights_count)
print(flights_selected)
print(airlines_flights_selected)
flights_count <- flights %>% count(year, month, day, sort = TRUE) %>% filter(n > 1000) %>% arrange(n)
flights_selected <- flights %>% select(year:day, hour, origin, dest, tailnum, carrier, arr_delay, dep_delay)
airlines_flights_selected <- airlines %>% left_join(flights_selected, by="carrier") %>% select(-origin,-dest)
print(flights_count)
print(flights_selected)
print(airlines_flights_selected)
flights_count <- flights %>% count(year, month, day, sort = TRUE) %>% filter(n > 1000) %>% arrange(n)
flights_selected <- flights %>% select(year:day, hour, origin, dest, tailnum, carrier, arr_delay, dep_delay)
airlines_flights_selected <- airlines %>% left_join(flights_selected, by="carrier") %>% select(-origin,-dest) %>% mutate(tot_delay = arr_delay+dep_delay)
print(flights_count)
print(flights_selected)
print(airlines_flights_selected)
flights_count <- flights %>% count(year, month, day, sort = TRUE) %>% filter(n > 1000) %>% arrange(n)
flights_selected <- flights %>% select(year:day, hour, origin, dest, tailnum, carrier, arr_delay, dep_delay)
airlines_flights_selected <- airlines %>% left_join(flights_selected, by="carrier") %>% select(-origin,-dest) %>% mutate(tot_delay = arr_delay+dep_delay)
precip_delay <- flights %>% inner_join(weather,by=c("year","month","day","hour","origin")) %>% group_by("precip")
print(flights_count)
print(flights_selected)
print(airlines_flights_selected)
print(precip_delay)
precip_delay <- flights %>% inner_join(weather,by=c("year","month","day","hour","origin"))
print(precip_delay)
flights_count <- flights %>% count(year, month, day, sort = TRUE) %>% filter(n > 1000) %>% arrange(n)
flights_selected <- flights %>% select(year:day, hour, origin, dest, tailnum, carrier, arr_delay, dep_delay)
airlines_flights_selected <- airlines %>% left_join(flights_selected, by="carrier") %>% select(-origin,-dest) %>% mutate(tot_delay = arr_delay+dep_delay)
precip_delay <- flights %>% inner_join(weather,by=c("year","month","day","hour","origin")) %>% group_by(precip)
print(flights_count)
print(flights_selected)
print(airlines_flights_selected)
print(precip_delay)
flights_count <- flights %>% count(year, month, day, sort = TRUE) %>% filter(n > 1000) %>% arrange(n)
flights_selected <- flights %>% select(year:day, hour, origin, dest, tailnum, carrier, arr_delay, dep_delay)
airlines_flights_selected <- airlines %>% left_join(flights_selected, by="carrier") %>% select(-origin,-dest) %>% mutate(tot_delay = arr_delay+dep_delay)
precip_delay <- flights %>% inner_join(weather,by=c("year","month","day","hour","origin")) %>% group_by(precip) %>% summarize(delay = mean(dep_delay))
print(flights_count)
print(flights_selected)
print(airlines_flights_selected)
print(precip_delay)
flights_count <- flights %>% count(year, month, day, sort = TRUE) %>% filter(n > 1000) %>% arrange(n)
flights_selected <- flights %>% select(year:day, hour, origin, dest, tailnum, carrier, arr_delay, dep_delay)
airlines_flights_selected <- airlines %>% left_join(flights_selected, by="carrier") %>% select(-origin,-dest) %>% mutate(tot_delay = arr_delay+dep_delay)
precip_delay <- flights %>% inner_join(weather,by=c("year","month","day","hour","origin")) %>% group_by(precip) %>% summarize(delay = mean(dep_delay,na.rm = TRUE))
print(flights_count)
print(flights_selected)
print(airlines_flights_selected)
print(precip_delay)
flights_count <- flights %>% count(year, month, day, sort = TRUE) %>% filter(n > 1000) %>% arrange(n)
flights_selected <- flights %>% select(year:day, hour, origin, dest, tailnum, carrier, arr_delay, dep_delay)
airlines_flights_selected <- airlines %>% left_join(flights_selected, by="carrier") %>% select(-origin,-dest) %>% mutate(tot_delay = arr_delay+dep_delay)
precip_delay <- flights %>% inner_join(weather,by=c("year","month","day","hour","origin")) %>% group_by(precip) %>% summarize(delay = mean(dep_delay,na.rm = TRUE)) %>% replace_na(list(delay = 0))
print(flights_count)
print(flights_selected)
print(airlines_flights_selected)
print(precip_delay)
flights_planes <- flights %>% inner_join(planes,by="tailnum")
print(flights_planes)
flights_airlines <- flights %>% inner_join(airlines,by="carrier")
print(flights_airlines)
flights_airports <- flights %>% inner_join(airports,by=c("origin"="faa")) %>% inner_join(airports,by=c("dest"="faa"))
print(flights_airports)
flights_weather <- flights %>% inner_join(weather,by=c("year","month","day","hour","origin"))
print(flights_weather)
flights_count <- flights %>% count(year, month, day, sort = TRUE) %>% filter(n > 1000) %>% arrange(n)
print(flights_count)
flights_selected <- flights %>% select(year:day, hour, origin, dest, tailnum, carrier, arr_delay, dep_delay)
print(flights_selected)
airlines_flights_selected <- airlines %>% left_join(flights_selected, by="carrier") %>% select(-origin,-dest) %>% mutate(tot_delay = arr_delay+dep_delay)
print(airlines_flights_selected)
precip_delay <- flights %>% inner_join(weather,by=c("year","month","day","hour","origin")) %>% group_by(precip) %>% summarize(delay = mean(dep_delay,na.rm = TRUE)) %>% replace_na(list(delay = 0))
print(precip_delay)
ggplot(precip_delay, aes(x=precip,y=delay))+ geom_point()
ggplot(precip_delay, aes(x=precip,y=delay))+ geom_point()
flights_airports <- fligths %>% filter(year == 2013, month == 5, day == 10)
flights_airports <- fligths %>% filter(year == 2013 & month == 5 &day == 10)
flights_airports <- flights %>% filter(year == 2013 & month == 5 &day == 10)
flights_airports <- flights %>% filter(year == 2013 & month == 5 &day == 10)
print(flights_airports)
flights_airports <- flights %>% filter(year == 2013 & month == 5 &day == 10) %>% group_by(dest) %>% summarize(delay = mean(arr_delay,na.rm = TRUE))
print(flights_airports)
flights_airports <- flights %>% filter(year == 2013 & month == 5 &day == 10) %>% group_by(dest) %>% summarize(delay = mean(arr_delay,na.rm = TRUE)) %>% inner_join(airports,by=c("dest","faa"))
flights_airports <- flights %>% filter(year == 2013 & month == 5 &day == 10) %>% group_by(dest) %>% summarize(delay = mean(arr_delay,na.rm = TRUE)) %>% inner_join(airports,by=c("dest"="faa"))
print(flights_airports)
flights_airports <- flights %>% filter(year == 2013 & month == 5 &day == 10) %>% group_by(dest) %>% summarize(delay = mean(arr_delay,na.rm = TRUE)) %>% inner_join(airports,by=c("dest"="faa"))
print(flights_airports)
ggplot(flights_airports, aes(x=lon,y=lat))+ geom_point(size=delay)
ggplot(flights_airports, aes(x=lon,y=lat),size=delay)+ geom_point()
ggplot(flights_airports, aes(x=lon,y=lat),size=delay, fill=delay)+ geom_point()
ggplot(flights_airports, aes(x=lon,y=lat))+ geom_point(aes(size=delay, fill=delay))
ggplot(flights_airports, aes(x=lon,y=lat))+ geom_point(aes(size=delay, colour=delay))
ggplot(flights_airports, aes(x=lon,y=lat))+ geom_point(aes(size=delay, colour=delay))
ggplot(flights_airports, aes(x=lon,y=lat))+ geom_point(aes(size=delay, colour=delay))
flights_planes_info <- flights %>% inner_join(planes,by="tailnum",suffix=c("_flights","_planes")) %>% transmute(pi = (dep_delay+arr_delay)/air_time)
print(flights_planes_info)
flights_planes_info <- flights %>% inner_join(planes,by="tailnum",suffix=c("_flights","_planes")) %>% transmute(tailnum, manufacturer, pi = (dep_delay+arr_delay)/air_time)
print(flights_planes_info)
View(flights)
View(airports)
View(planes)
View(airlines)
View(weather)
View(flights)
View(airports)
View(planes)
View(airlines)
View(weather)
flights_count <- flights %>% count(year, month, day, sort = TRUE) %>% filter(n > 1000) %>% arrange(n)
library(tidyverse)
flights_planes <- flights %>% inner_join(planes,by="tailnum")
library(nycflights13)
flights_planes <- flights %>% inner_join(planes,by="tailnum")
print(flights_planes)
flights_airlines <- flights %>% inner_join(airlines,by="carrier")
print(flights_airlines)
flights_airports <- flights %>% inner_join(airports,by=c("origin"="faa")) %>% inner_join(airports,by=c("dest"="faa"))
print(flights_airports)
flights_weather <- flights %>% inner_join(weather,by=c("year","month","day","hour","origin"))
print(flights_weather)
flights_count <- flights %>% count(year, month, day, sort = TRUE) %>% filter(n > 1000) %>% arrange(n)
print(flights_count)
flights_selected <- flights %>% select(year:day, hour, origin, dest, tailnum, carrier, arr_delay, dep_delay)
print(flights_selected)
airlines_flights_selected <- airlines %>% left_join(flights_selected, by="carrier") %>% select(-origin,-dest) %>% mutate(tot_delay = arr_delay+dep_delay)
print(airlines_flights_selected)
precip_delay <- flights %>% inner_join(weather,by=c("year","month","day","hour","origin")) %>% group_by(precip) %>% summarize(delay = mean(dep_delay,na.rm = TRUE)) %>% replace_na(list(delay = 0))
print(precip_delay)
ggplot(precip_delay, aes(x=precip,y=delay))+ geom_point()
flights_airports <- flights %>% filter(year == 2013 & month == 5 &day == 10) %>% group_by(dest) %>% summarize(delay = mean(arr_delay,na.rm = TRUE)) %>% inner_join(airports,by=c("dest"="faa"))
print(flights_airports)
ggplot(flights_airports, aes(x=lon,y=lat))+ geom_point(aes(size=delay, colour=delay))
flights_planes_info <- flights %>% inner_join(planes,by="tailnum",suffix=c("_flights","_planes")) %>% transmute(tailnum, manufacturer, pi = (dep_delay+arr_delay)/air_time)
print(flights_planes_info)
